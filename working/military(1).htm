<!doctype html>
<!-- military.html -->
<html>
<head>
	<script type="text/javascript"
	        src="https://www.gstatic.com/charts/loader.js"></script>
	<script type="text/javascript">
		//load the google charts
		google.charts.load('current',{'packages':['corechart']});
		
		//load the Callback function that runs when page loads
		google.charts.setOnLoadCallback(drawAllSheets);
		
		function drawAllSheets() {
			drawSheetName('militaryspending', 
						  'SELECT A,B,C,D,E,F',
						  militarySpendingResponseHandler);
			drawSheetName('militaryspending',
			              'SELECT A,F',
						  topMilitarySpendingResponseHandler);
			drawSheetName('meanmilitaryspending',
						  'SELECT A,G',
						  averageSpendingResponseHandler);
			drawSheetName('sharedgdp',
						  'SELECT A,B,C,D,E,F',
						  sharedGDPResponseHandler);
			drawSheetName('sharedgdp',
						  'SELECT A,F',
						  topSharedGDPResponseHandler);
			drawSheetName('percapita', 'SELECT A, F',
			              topPerCapitaResponseHandler);
			drawSheetName('percapitaGDP',
						  'SELECT A,P,Q,R,S,T',
						  perCapitaGDPResponseHandler);
			drawSheetName('totalgdp', 'SELECT A,F,S',
						  totalGDPMilitarySpendingResponseHandler);
			drawSheetName('percapitaGDP', 'SELECT A,T,F',
						  perCapitaMilitarySpendingResponseHandler);
			drawSheetName('annualgrowth', 'SELECT A,G',
						  annualGrowthResponseHandler);
		} //drawAllSheets
		
		function drawSheetName(sheetName, query, responseHandler) {
			var queryString = encodeURIComponent(query);
			var query = new google.visualization.Query(
				'https://docs.google.com/spreadsheets/d/1-NwogHiqjRPfIEeh7XxgDYj1CIjyzrz7hxYus4I2VQY/gviz/tq?sheet=' +
							sheetName + '&headers=1&tq=' + queryString);
			query.send(responseHandler);
		} //drawSheetName
		
		function militarySpendingResponseHandler(response) {
			var data = response.getDataTable();
			data.sort({column:5, desc:true});
			var options = {
						height: 400,
						vAxis: {title: 'Spending in Billions ($)'},
						hAxis: {title: 'Country'}
			};
			
			var chart = new google.visualization.ColumnChart(
						document.getElementById('military_spending_div'));
			
			chart.draw(data, options);
		} //militarySpendingResponseHandler
		
		function topMilitarySpendingResponseHandler(response) {
			var data = response.getDataTable();
			data.sort({column:1, desc:true});
			
			var options = {
						height: 400,
						colorAxis: {colors: ['#e7711c', '#4374e0']}, //orange to blue
						title: 'Top 10 Military Spenders Billions $ (2015)'
			};
			
			var chart = new google.visualization.GeoChart(
						document.getElementById('top_military_spending_div'));
			
			chart.draw(data, options);
		} //topMilitarySpendingResponseHandler
		
		function averageSpendingResponseHandler(response) {
			var data = response.getDataTable();
			data.sort({column:1, desc:true});
			
			var options = {
						height: 400,
						legend: 'none',
						bars: 'horizontal',
						vAxis: {title: 'Spending in Billions ($)'},
						hAxis: {title: 'Country'}
			};
			
			/* using data directly
			var formatter = new google.visualization.NumberFormat(
						{fractionDigits: 2, prefix: '$'});
			formatter.format(data, 1); //apply the formatting to column 1
			*/
			
			/* using a view */
			var view = new google.visualization.DataView(data);
			
			view.setColumns([0,1, {
					calc: function(dt, row) {
			return Math.floor(dt.getFormattedValue(row,1)) + 'B';
					},
					sourceColumn: 1,
					type: 'string',
					role: 'annotation'					
			}]);
			
			var chart = new google.visualization.BarChart(
					document.getElementById('avg_spending_div'));
			
			chart.draw(view, options); //change data to view
			
		} //averageSpendingResponseHandler
		
		function sharedGDPResponseHandler(response) {
			var data = response.getDataTable();
			data.sort({column:5, desc:true});
			
			options = {height: 400};
			
			var chart = new google.visualization.ColumnChart(
						document.getElementById('shared_gdp_div'));
			chart.draw(data, options);
		} //sharedGDPResponseHandler
		
		function topSharedGDPResponseHandler(response) {
			var data = response.getDataTable();
			
			var options = {
						height: 400,
						legend: 'none',
						bars: 'horizontal',
						annotations: {alwaysOutside: true},
						title: 'Top 10 Countries by Military Expense as % GDP (2015)',
						vAxis: {title: 'Country'},
						hAxis: {title: '%'}
			};
			
			data.sort({column: 1, desc: true});
			
			var chart = new google.visualization.BarChart(document.getElementById(
						'top_shared_gdp_div'));
			chart.draw(data, options);
			
		} //topSharedGDPResponseHandler
		
		function topPerCapitaResponseHandler(response) {
			var data = response.getDataTable();
			
			data.sort({column: 1, desc: true});
			
			var chart = new google.visualization.ColumnChart(document.getElementById(
						'top_per_capita_div'));
			
			chart.draw(data, {height: 400});
			
		} //topPerCapitaResponseHandler
		
		function perCapitaGDPResponseHandler(response) {
		
			var data = response.getDataTable();
			data.sort({column:5, desc:true});
			
			var options = {
						width: 600,
						height: 400,
						legend: {position: 'top', maxLines: 3},
						bar: {groupWidth: '50%'},
						isStacked: true
			};
			
			var chart = new google.visualization.BarChart(document.getElementById(
						'per_capita_gdp_div'));
			
			chart.draw(data, options);
		
		} //perCapitaGDPResponseHandler
		
		function totalGDPMilitarySpendingResponseHandler(response) {
			var data = response.getDataTable();
			data.sort({column:1, desc: true});
			
			var options = {
						height: 400,
						legend: 'none',
						bars: 'horizontal',
						isStacked: true,
						annotations: {alwaysOutside: true},
						title: 'Military Spending vs. GDP (2015)',
						vAxis: {title: 'Country'},
						hAxis: {title: 'Spending in Billions ($)'}
			};
			
			var chart = new google.visualization.BarChart(document.getElementById(
						'total_gdp_military_spending_div'));
			
			chart.draw(data, options);
			
		} //totalGDPMilitarySpendingResponseHandler
		
		function perCapitaMilitarySpendingResponseHandler(response) {
			var data = response.getDataTable();
			data.sort({column:1, desc: true});
			
			var options = {
						height: 400,
						legend: 'none',
						bars: 'horizontal',
						isStacked: true,
						annotations: {alwaysOutside: true},
						title: 'Per Capita Military Spending vs. Per Capita GDP (2015)',
						vAxis: {title: 'Country'},
						hAxis: {title: 'Spending in Billions ($)'}
			};		

			var chart = new google.visualization.BarChart(document.getElementById(
						'per_capita_gdp_military_spending_div'));
			
			chart.draw(data, options);
			
		} //perCapitaMilitarySpendingResponseHandler
		
		function annualGrowthResponseHandler(response) {
			var data = response.getDataTable();
			data.sort({column: 1, desc:true});
			
			var chart = new google.visualization.GeoChart(document.getElementById(
						'annual_growth_div'));
			
			chart.draw(data, {'height': 400});
		} //annualGrowthResponseHandler
		
	</script>
</head>
<body>
	<h2>Military Analysis of top 10 G20 Countries</h2>
	<div id="military_spending_div"
		 style="width:900px; height:500px;"></div>
	
	<h2>Top 10 Military Spending in 2015</h2>
	<div id="top_military_spending_div"
	     style="width:900px; height:500px;"></div>
		 
	<h2>Average Military Spending by Country (2011-2015)</h2>
	<div id="avg_spending_div"
	     style="width: 900px; height: 500px;"></div>
		 
	<h2>Military Expenditure by Country as a % of GDP (2011-2015)</h2>
	<div id="shared_gdp_div"
	     style="width:900px; height:500px;"></div>
		 
	<h2>Top 10 Countries by Military Spending as % of GDP (2015)</h2>
	<div id="top_shared_gdp_div"
	     style="width:900px; height:500px;"></div>
		 
	<h2>Top Countries by Military Spending Per Capita (2015)</h2>
	<div id="top_per_capita_div"
	     style="width:900px; height:500px;"></div>
		 
	<h2>Per Capita GDP of all 10 Countries for 5 Years</h2>
	<div id="per_capita_gdp_div"
	     style="width:900px; height:500px;"></div>
		 
	<h2>Military Spending vs. GDP (2015)</h2>
	<div id="total_gdp_military_spending_div"
	     style="width:900px; height:500px;"></div>
		 
	<h2>Per Capita Military Spending vs. Per Capita GDP (2015)</h2>
	<div id="per_capita_gdp_military_spending_div"
	     style="width:900px; height:500px;"></div>
	
	<h2>Fastest Growing Nations Based on Military Spending</h2>
	<div id="annual_growth_div"
	     style="width:900px; height:500px;"></div>
</body>
</html>